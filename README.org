#+title: Ollama Buddy: Local LLM Integration for Emacs
#+author: James Dyer
#+email: captainflasmr@gmail.com
#+language: en
#+options: ':t toc:nil author:nil email:nil num:nil title:nil
#+startup: showall

#+attr_org: :width 300px
#+attr_html: :width 50%
[[file:img/ollama-buddy-youtube-banner_001.jpg]]

* Ollama Buddy

An Emacs package for interacting with local LLMs via [[https://ollama.ai/][Ollama]], with support for remote providers (OpenAI, Claude, Gemini, Grok, Copilot, Codestral) and Ollama Cloud models. Requires Emacs 28.1+.

#+begin_src elisp
(use-package ollama-buddy
  :ensure t
  :bind
  ("C-c o" . ollama-buddy-role-transient-menu)
  ("C-c O" . ollama-buddy-transient-menu-wrapper))
#+end_src

That's it. Start =ollama serve=, open Emacs, press =C-c o=, select =[o]= to open chat, and go.

https://www.youtube.com/@OllamaBuddyforEmacs

** Tool Calling Demo

LLMs can invoke Emacs functions: read/write files, execute shell commands, search buffers, and more.

#+attr_org: :width 300px
#+attr_html: :width 100%
[[file:img/ollama-buddy-screen-recording_034.gif]]

** Quick Demo

Submit queries, swap models, view token usage and statistics:

#+attr_org: :width 300px
#+attr_html: :width 100%
[[file:img/ollama-buddy-screen-recording_011.gif]]

* Features

- *Tool Calling* -- LLMs can invoke registered Emacs functions (file ops, shell commands, buffer search, calculations). Safe mode restricts to read-only tools.
- *Multiple Providers* -- Local Ollama, Ollama Cloud, OpenAI, Claude, Gemini, Grok, GitHub Copilot, Codestral
- *Web Search* -- Inline =@search(query)= syntax for real-time web search via Ollama's API
- *Interactive Menus* -- Transient popup menus with role-based command grouping
- *Roles & Presets* -- Switchable command configurations (developer, writer, tutor, documenter, custom)
- *Sessions & History* -- Save/load conversations, prompt history navigation
- *File Attachments* -- Attach files and images (vision models) to conversations
- *Model Management* -- Pull, delete, copy models; categorized recommendations; cloud model support
- *Multishot* -- Send the same prompt to multiple models simultaneously
- *Parameters* -- Full control over temperature, top_k, top_p, and all Ollama API options
- *Fabric Patterns* -- Integration with [[https://github.com/danielmiessler/fabric][Fabric]] prompt patterns
- *Token Tracking* -- Real-time token usage statistics with graphs
- *Lightweight* -- No external dependencies; a minified 200-line version (=ollama-buddy-mini=) is also available

* What's New (2.0.0)

- *Tool Calling* -- New =ollama-buddy-tools.el= module with 8 built-in tools and a registration API for custom tools
- *⚒/⊙ Indicators* -- Tool-capable and vision-capable models marked in header line and model management
- *Dynamic Role Menus* -- Transient popup with grouped commands per role
- *Tone Selector* -- Switch response style (Concise, Learning, Formal, etc.)
- *Web Search* -- =@search()= inline syntax and manual search commands
- *Cloud Models* -- Ollama cloud model support with browser-based auth
- *GitHub Copilot* -- OAuth device flow, no API key needed

See [[file:CHANGELOG.org]] for full history.

* Installation

** MELPA

#+begin_src elisp
(use-package ollama-buddy
  :ensure t
  :bind
  ("C-c o" . ollama-buddy-role-transient-menu)
  ("C-c O" . ollama-buddy-transient-menu-wrapper))
#+end_src

** With Remote Providers

#+begin_src elisp
(use-package ollama-buddy
  :ensure t
  :bind
  ("C-c o" . ollama-buddy-role-transient-menu)
  ("C-c O" . ollama-buddy-transient-menu-wrapper)
  :custom
  (ollama-buddy-openai-api-key
   (auth-source-pick-first-password :host "ollama-buddy-openai" :user "apikey"))
  :config
  (require 'ollama-buddy-openai nil t)
  (require 'ollama-buddy-claude nil t)
  (require 'ollama-buddy-gemini nil t)
  (require 'ollama-buddy-copilot nil t))
#+end_src

** Manual

#+begin_src shell
git clone https://github.com/captainflasmr/ollama-buddy.git
#+end_src

#+begin_src elisp
(add-to-list 'load-path "path/to/ollama-buddy")
(require 'ollama-buddy)
(global-set-key (kbd "C-c o") #'ollama-buddy-role-transient-menu)
(global-set-key (kbd "C-c O") #'ollama-buddy-transient-menu-wrapper)
#+end_src

* Key Bindings (Chat Buffer)

| Key       | Action                        |
|-----------+-------------------------------|
| C-c C-c   | Send prompt                   |
| C-c RET   | Send prompt (alt)             |
| C-c C-k   | Cancel request                |
| C-c m     | Change model                  |
| C-u C-c m | Select cloud model            |
| C-c M     | Manage models                 |
| C-c O     | Main transient menu           |
| M-p / M-n | Browse prompt history         |
| C-c a     | Attach file                   |
| C-c 0     | Clear attachments             |
| C-c ~     | Select response tone          |
| C-c e     | Switch backend (network/curl) |

* Screenshots & Demos

See the [[file:README-full.org][full README]] for all 30+ demos with descriptions, or browse the [[https://www.youtube.com/@OllamaBuddyforEmacs][YouTube channel]].

| Demo | Topic                        |
|------+------------------------------|
| [[file:img/ollama-buddy-screen-recording_034.gif][034]]  | Tool Calling                 |
| [[file:img/ollama-buddy-screen-recording_024.gif][024]]  | Web Search (@search syntax)  |
| [[file:img/ollama-buddy-screen-recording_023.gif][023]]  | Cloud Models                 |
| [[file:img/ollama-buddy-screen-recording_027.gif][027]]  | Dynamic Role Menus           |
| [[file:img/ollama-buddy-screen-recording_031.gif][031]]  | GitHub Copilot Integration   |
| [[file:img/ollama-buddy-screen-recording_021.gif][021]]  | Vision Model (Image to Text) |
| [[file:img/ollama-buddy-screen-recording_001.gif][001]]  | First Steps                  |

* Documentation

- [[file:docs/ollama-buddy.org][Manual]] -- Full reference manual
- [[file:README-full.org][Full README]] -- Detailed README with all demos, tutorials, transient menu guide, and role setup
- [[file:README-features.org][Feature History]] -- Detailed feature descriptions as they were added
- [[file:CHANGELOG.org][Changelog]] -- Version-by-version changes
